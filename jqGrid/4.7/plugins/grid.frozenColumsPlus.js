(function(a){a.jgrid.extend({setFrozenColumns:function(d){a(this).jqGrid("setFrozenColumnsPlus","right")},setFrozenColumnsPlus:function(d){return this.each(function(){if(this.grid){d||(d="left");var b=this,c=b.p.colModel,e=0,n=c.length,f=-1,l=!1,g="left"==d;b.grid.fcs||(b.grid.fcs={left:{},right:{}});if(!0!==b.p.subGrid&&!0!==b.p.treeGrid&&!0!==b.p.cellEdit&&!b.p.sortable&&!b.p.scroll){if(g)for(b.p.rownumbers&&e++,b.p.multiselect&&e++;e<n;){if(!0===c[e].frozen)l=!0,f=e;else break;e++}else for(e=n-
1;0<e;){if(!0===c[e].frozen)l=!0,f=e;else break;e--}if(0<=f&&l){c=b.p.caption?a(b.grid.cDiv).outerHeight():0;e=a(".ui-jqgrid-htable","#gview_"+a.jgrid.jqID(b.p.id)).height();b.p.toppager&&(c+=a(b.grid.topDiv).outerHeight());!0===b.p.toolbar[0]&&"bottom"!==b.p.toolbar[1]&&(c+=a(b.grid.uDiv).outerHeight());b.grid.fcs[d].fhDiv=a('<div style="position:absolute;'+(g?"left:0":"right:11px")+";top:"+c+"px;height2:"+e+'px;z-index:1" class="frozen-div ui-state-default ui-jqgrid-hdiv"></div>');b.grid.fcs[d].fbDiv=
a('<div style="position:absolute;'+(g?"left:0":"right:11px")+";top:"+(parseInt(c,10)+parseInt(e,10))+'px;overflow:hidden" class="frozen-bdiv ui-jqgrid-bdiv"></div>');a("#gview_"+a.jgrid.jqID(b.p.id)).append(b.grid.fcs[d].fhDiv);c=a(".ui-jqgrid-htable","#gview_"+a.jgrid.jqID(b.p.id)).clone(!0);if(b.p.groupHeader||b.p.groupHeaders){a("tr.jqg-first-row-header,tr.jqg-third-row-header,tr.jqg-four-row-header",c).each(function(){g?a("th:gt("+f+")",this).remove():a("th:lt("+f+")",this).remove()});var k=-1,
h=-1,m,p;a("tr.jqg-second-row-header th",c).each(function(){m=parseInt(a(this).attr("colspan"),10);if(p=parseInt(a(this).attr("rowspan"),10))k++,h++;m&&(k+=m,h++);if(k===f)return!1});k!==f&&(h=f);a("tr.jqg-second-row-header",c).each(function(){0<h?g?a("th:gt("+h+")",this).remove():a("th:lt("+h+")",this).remove():a("th",this).remove()})}else a("tr",c).each(function(){g?a("th:gt("+f+")",this).remove():a("th:lt("+f+")",this).remove()});a(c).width(1);a(b.grid.fcs[d].fhDiv).append(c).mousemove(function(a){if(b.grid.resizing)return b.grid.dragMove(a),
!1});b.p.footerrow&&(a(".ui-jqgrid-bdiv","#gview_"+a.jgrid.jqID(b.p.id)).height(),b.grid.fcs[d].fsDiv=a('<div style="position:absolute;left:0px;bottom:0px;" class="frozen-sdiv ui-jqgrid-sdiv"></div>'),a("#gview_"+a.jgrid.jqID(b.p.id)).append(b.grid.fcs[d].fsDiv),c=a(".ui-jqgrid-ftable","#gview_"+a.jgrid.jqID(b.p.id)).clone(!0),a("tr",c).each(function(){g?a("td:gt("+f+")",this).remove():a("td:lt("+f+")",this).remove()}),a(c).width(1),a(b.grid.fcs[d].fsDiv).append(c));a(b).bind("jqGridResizeStop.setFrozenColumns",
function(c,e,f){c=a(".ui-jqgrid-htable",b.grid.fcs[d].fhDiv);a("th:eq("+f+")",c).width(e);c=a(".ui-jqgrid-btable",b.grid.fcs[d].fbDiv);a("tr:first td:eq("+f+")",c).width(e);b.p.footerrow&&(c=a(".ui-jqgrid-ftable",b.grid.fcs[d].fsDiv),a("tr:first td:eq("+f+")",c).width(e))});a(b).bind("jqGridSortCol.setFrozenColumns",function(c,e,f){c=a("tr.ui-jqgrid-labels:last th:eq("+b.p.lastsort+")",b.grid.fcs[d].fhDiv);e=a("tr.ui-jqgrid-labels:last th:eq("+f+")",b.grid.fcs[d].fhDiv);a("span.ui-grid-ico-sort",
c).addClass("ui-state-disabled");a(c).attr("aria-selected","false");a("span.ui-icon-"+b.p.sortorder,e).removeClass("ui-state-disabled");a(e).attr("aria-selected","true");b.p.viewsortcols[0]||b.p.lastsort===f||(a("span.s-ico",c).hide(),a("span.s-ico",e).show())});a("#gview_"+a.jgrid.jqID(b.p.id)).append(b.grid.fcs[d].fbDiv);a(b.grid.bDiv).scroll(function(){a(b.grid.fcs[d].fbDiv).scrollTop(a(this).scrollTop())});!0===b.p.hoverrows&&a("#"+a.jgrid.jqID(b.p.id)).unbind("mouseover").unbind("mouseout");
a(b).bind("jqGridAfterGridComplete.setFrozenColumns",function(){log(a("#"+a.jgrid.jqID(b.p.id)+"_frozen").length);a("#"+a.jgrid.jqID(b.p.id)+"_frozen").remove();a(b.grid.fcs[d].fhDiv).height(a(b.grid.hDiv).height());a(b.grid.fcs[d].fbDiv).height(a(b.grid.bDiv).height()-16+(a.jgrid.bigscroll?0:4));var c=a("#"+a.jgrid.jqID(b.p.id)).clone(!0);log(c);a("tr[role=row]",c).each(function(){g?a("td[role=gridcell]:gt("+f+")",this).remove():a("td[role=gridcell]:lt("+f+")",this).remove()});a(c).width(1).attr("id",
b.p.id+"_frozen");a(b.grid.fcs[d].fbDiv).append(c);a(b.grid.bDiv).scroll();!0===b.p.hoverrows&&(a("tr.jqgrow",c).hover(function(){a(this).addClass("ui-state-hover");a("#"+a.jgrid.jqID(this.id),"#"+a.jgrid.jqID(b.p.id)).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover");a("#"+a.jgrid.jqID(this.id),"#"+a.jgrid.jqID(b.p.id)).removeClass("ui-state-hover")}),a("tr.jqgrow","#"+a.jgrid.jqID(b.p.id)).hover(function(){a(this).addClass("ui-state-hover");a("#"+a.jgrid.jqID(this.id),
"#"+a.jgrid.jqID(b.p.id)+"_frozen").addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover");a("#"+a.jgrid.jqID(this.id),"#"+a.jgrid.jqID(b.p.id)+"_frozen").removeClass("ui-state-hover")}));c=null});b.grid.hDiv.loading||a(b).triggerHandler("jqGridAfterGridComplete");b.p.frozenColumns=!0}}}})},destroyFrozenColumns:function(d){return this.each(function(){if(this.grid&&(d||(d="left"),!0===this.p.frozenColumns)){a(this.grid.fcs[d].fhDiv).remove();a(this.grid.fcs[d].fbDiv).remove();
this.grid.fcs[d].fhDiv=null;this.grid.fcs[d].fbDiv=null;this.p.footerrow&&(a(this.grid.fcs[d].fsDiv).remove(),this.grid.fcs[d].fsDiv=null);a(this).unbind(".setFrozenColumns");if(!0===this.p.hoverrows){var b;a("#"+a.jgrid.jqID(this.p.id)).bind("mouseover",function(c){b=a(c.target).closest("tr.jqgrow");"ui-subgrid"!==a(b).attr("class")&&a(b).addClass("ui-state-hover")}).bind("mouseout",function(c){b=a(c.target).closest("tr.jqgrow");a(b).removeClass("ui-state-hover")})}this.p.frozenColumns=!1}})}})})(jQuery);
